<% contentFor('body') %>
<div class="admin-container">
  <div class="admin-breadcrumbs">
    <a href="/admin">Панель администратора</a> / <span>Статистика</span>
  </div>
  
  <h1 class="page-title">Статистика платформы</h1>
  
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-value" id="total-users"><%= summary.usersCount %></div>
      <div class="stat-label">Всего пользователей</div>
    </div>
    <div class="stat-card">
      <div class="stat-value" id="total-courses"><%= summary.coursesCount %></div>
      <div class="stat-label">Всего курсов</div>
    </div>
    <div class="stat-card">
      <div class="stat-value" id="total-enrollments"><%= summary.enrollmentsCount %></div>
      <div class="stat-label">Всего записей на курсы</div>
    </div>
    <div class="stat-card">
      <div class="stat-value" id="total-completed"><%= summary.completedEnrollments %></div>
      <div class="stat-label">Завершено курсов</div>
    </div>
  </div>
  
  <div class="chart-container">
    <div class="chart-header">
      <h4 class="chart-title">Регистрации пользователей</h4>
      <div class="chart-options">
        <select id="user-stats-period">
          <option value="week">Неделя</option>
          <option value="month" selected>Месяц</option>
          <option value="year">Год</option>
        </select>
      </div>
    </div>
    <canvas id="user-registration-chart"></canvas>
  </div>
  
  <div class="chart-container">
    <div class="chart-header">
      <h4 class="chart-title">Активность пользователей</h4>
      <div class="chart-options">
        <select id="activity-stats-period">
          <option value="week">Неделя</option>
          <option value="month" selected>Месяц</option>
          <option value="year">Год</option>
        </select>
      </div>
    </div>
    <canvas id="user-activity-chart"></canvas>
  </div>
  
  <div class="chart-container">
    <div class="chart-header">
      <h4 class="chart-title">Распределение пользователей по ролям</h4>
    </div>
    <canvas id="user-roles-chart"></canvas>
  </div>
</div>

<% contentFor('style') %>
<link rel="stylesheet" href="/css/admin.css">

<% contentFor('script') %>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="/js/admin/statistics.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', async function() {
    const adminStatistics = new AdminStatistics();
    await adminStatistics.init();
  });
</script>
